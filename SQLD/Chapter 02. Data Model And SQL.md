# Chapter 02. 데이터 모델과 SQL

## ⭐ Introduction

### 📌 Aims

* 데이터 모델을 더 깊게 이해하여 숨겨진 의미를 파악하고 SQL 개발 시 필요한 지식을 습득한다.

<br>

### 📌 Summary

1. 정규화

2. 관계와 조인의 이해

3. 모델이 표현하는 트랜잭션의 이해

4. Null 속성의 이해

5. 본질 식별자 VS 인조식별자

<br>



## ⭐ Contents

### 📌 1. 정규화

#### ✒ 정의

* 데이터베이스의 설계에서 중복을 최소화하게 데이터를 구조화하는 프로세스
* 정규형(NF, Normal Form): 정규화된 정도를 의미

<br>

#### ✒ 1NF: 도메인의 원자성

* 모든 속성의 값은 반드시 하나의 값을 가져야 한다.

<br>

#### ✒ 2NF: 부분적 함수 종속 제거

* 데이터의 일반속성은 주식별자 전체에 종속적이어야한다.
* 부분적 함수 종속(Partial)이란? 릴레이션 R에 속성 집합 X, Y가 있다고 가정할 때, X값을 알면 Y 값을 식별할 수 있고, X의 값에 따라 Y 값이 달라질때 Y는 X의 부분적 함수 종속 관계라고 할수 있다. 이때 X는 결정자, Y는 종속자라고 한다.

<br>

#### ✒ 3NF: 이행적 함수 종속 제거

* 엔터티의 일반속성 간에는 서로 종속적이지 않는다.
* 이행적 함수 종속(Transitive)이란? X -> Y, Y -> Z 일때 X -> Z의 관계가 성립하면 이행적 함수종속 관계이다.

<br>

#### ✒ BCNF

* Boyce-Codd Nomal Form
* 기본키를 제외하고 후보키가 있는 경우, 후보키가 기본키를 종속시키면 분해한다.

<br>

#### ✒  4NF: 다치 종속성 제거

* 다치 속성: 두 개이상의 값을 가지는 속성
* 여러 속성들이 하나의 속성을 종속시키는 경우, 분해하여 다중값 종속성을 제거한다.

#### ✒  5NF: 조인에 의해 종속성 제거

<br>

#### ✒ 반정규화

* 역정규화라고도 한다.
* 정규화는 데이터의 중복을 최소화 했다면, 반정규화는 성능을 위해 데이터의 중복을 허용하는 것을 의미한다.
* 반정규화는 데이터 불일치로 인한 정합성 문제 뿐 아니라, 불필요한 트랜잭션으로 인한 성능문제를 만들어낸다.

<br>

### 📌 2. 관계와 조인의 이해

#### ✒ 관계와 조인

* 관계: 상호 연관성이 있는 상태
* 특수 엔터티를 제외한 모든 엔터티는 1개 이상의 관계를 맺는다. (부모의 식별자를 자식의 식별자에 포함하면 식별관계, 일반속성으로 상속하면 비식별관계)
* 조인: 식별자를 상속하여(관계를 맺고), 상속된 속성을 매핑키로 활용하여 데이터를 결합하는 것

<br>

#### ✒ 계층적 데이터 모델

* 계층적 데이터 모델이란? 말 그대로 계층 구조를 가진 데이터를 지칭하는 것.
* 셀프조인(Self-Join)이 가능하다. 자기 자신에서 관계를 맺은 것을 볼수 있으며, 관계를 맺으면 주식별자를 상속한다.

<br>

#### ✒ 상호배타적 관계(Exclusive-OR)

- Exclusive-OR: 주어진 2개의 명제 가운데 1개만 참일 경우를 판단하는 논리연산.

<br>

### 📌 3. 모델이 표현하는 트랜잭션의 이해

* 트랜잭션이란? 데이터베이스의 논리적 연산단위
* 트랜잭션을 하나로 묶는다는 것은 All or Nothing으로 원자성이 보장되도록 개발해야한다는 것(= Commit 의 단위를 하나로 묶어야하는 것)
* 예시: 계좌이체

<br>

### 📌 4. NULL 속성의 이해

* NULL 값의 연산은 언제나 NULL이다.
* 집계함수는 NULL 값을 제외하고 처리한다.

<br>

### 📌 5. 본질식별자 vs 인조식별자

#### ✒ 정의

* 본질식별자: 업무에 의해 만들어진 식별자
* 인조식별자: 업무적으로는 만들어지지 않지만 본질 식별자가 복잡한 구성을 갖고 있으므로 인위적으로 만든 식별자



#### ✒  사례

* 시퀀스 객체를 생성하고 NEXTVAL 기능을 이용하여 자동으로 값을 채번하는 경우

* 왜이런 모델을 생성했을까? 본질식별자에 대한 고민을 하지 않음, 식별자는 유일성과 존재성만 만족하면 된다고 생각함



#### ✒ 문제점

* 중복 데이터로 인한 품질; 데이터베이스단에서 원천 차단해주지 않기 때문에 애플리케이션에서 방어해줘야 함.

* 불필요한 인덱스 생성; 데이터베이스는 PK로 지정된 속성에 대한 인덱스를 생성해주는데, 인조식별자를 PK로 지정하면 불필요한 인덱스가 생성된다.